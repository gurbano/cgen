!function t(e,r,i){function o(n,a){if(!r[n]){if(!e[n]){var p="function"==typeof require&&require;if(!a&&p)return p(n,!0);if(s)return s(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var h=r[n]={exports:{}};e[n][0].call(h.exports,function(t){var r=e[n][1][t];return o(r?r:t)},h,h.exports,t,e,r,i)}return r[n].exports}for(var s="function"==typeof require&&require,n=0;n<i.length;n++)o(i[n]);return o}({"/home/gurbano/workspace/snippets/cgen/app/scripts/app/cgen.js":[function(t,e,r){"use strict";var i=t("./modules/WorldLoader"),o=t("./modules/UserStore"),s=["left","right","up","down"],n={VIEW_ANGLE:45,NEAR:.1,FAR:1e4},a=(THREE.Vector3(1,0,0),THREE.Vector3(0,0,0),function(t,e){var r=this;s.forEach(function(t){r.S.keys[t]=r.keyboard.pressed(t)})}),p=function(t,e){this.PG.entity&&this.PG.entity.update(this.S.keys)},c=function(t,e){if(this.world&&this.world.intersect){var r=this.world.get("axisHelper");r.position.x=this.world.intersect.x,r.position.y=this.world.intersect.y,r.position.z=this.world.intersect.z,this.world.dig(this.world.intersect.obj)}},h=function(t,e){this.S.camera&&this.PG.entity&&(this.S.camera.position.x=this.PG.entity.position.x,this.S.camera.position.y=this.PG.entity.position.y,this.S.camera.position.z=this.PG.entity.position.z,this.S.camera.lookAt(this.world.get("helper").position))},u=function(t){this.targetId=t.target,this.target=$("#"+t.target),this.PG={},this.PG.store=new o(t.userId),this.PG.entity=this.PG.store.get(),this.updateFcts=[],this.updateFcts.push(a),this.updateFcts.push(p),this.updateFcts.push(h),this.updateFcts.push(c),this.S={},this.S.keys={},this.S.scene=void 0,this.S.renderer=void 0};u.prototype.hello=function(t){return console.info("Hello "+this.PG.entity.userName),this},u.prototype.initHardware=function(t){return n.WIDTH=this.target.width(),n.HEIGHT=this.target.height(),n.ASPECT=n.WIDTH/n.HEIGHT,console.info("Application initialized",n.WIDTH,n.HEIGHT),this.keyboard=new THREEx.KeyboardState,this.S.scene=new THREE.Scene,this.S.camera=new THREE.PerspectiveCamera(n.VIEW_ANGLE,n.ASPECT,n.NEAR,n.FAR),this.S.scene.add(this.S.camera),this.S.renderer=new THREE.WebGLRenderer,this.S.renderer.setSize(n.WIDTH,n.HEIGHT),this.target.append(this.S.renderer.domElement),this},u.prototype.initWorld=function(t){this.world=new i(this).init(),this.S.scene.add(this.world.getRoot());var e=new THREE.PointLight(16777215);return e.position.x=10,e.position.y=50,e.position.z=130,this.S.scene.add(e),this},u.prototype.start=function(){return console.info("Application started"),this.loop(),this},u.prototype.queryControls=function(t){return this.S.keys[t]},u.prototype.loop=function(){function t(i){requestAnimationFrame(t.bind(e)),r=r||i-1e3/60;var o=Math.min(200,i-r);r=i,e.updateFcts.forEach(function(t){t.bind(e)(o/1e3,i/1e3)}),this.S.renderer.render(this.S.scene,this.S.camera)}var e=this,r=null;requestAnimationFrame(t.bind(e))},e.exports=u},{"./modules/UserStore":"/home/gurbano/workspace/snippets/cgen/app/scripts/app/modules/UserStore.js","./modules/WorldLoader":"/home/gurbano/workspace/snippets/cgen/app/scripts/app/modules/WorldLoader.js"}],"/home/gurbano/workspace/snippets/cgen/app/scripts/app/modules/UserStore.js":[function(t,e,r){"use strict";var i={x:0,y:2e3,z:2e3},o=function(t){this.userId=t};o.prototype.get=function(){return{position:i,userId:this.userId,userName:"gurbano",update:function(t){}}},o.prototype.set=function(t){i.x=t.position.x,i.y=t.position.y,i.z=t.position.z},e.exports=o},{}],"/home/gurbano/workspace/snippets/cgen/app/scripts/app/modules/WorldLoader.js":[function(t,e,r){"use strict";function i(){var t=new THREE.CylinderGeometry(0,20,100,3);return t.translate(0,50,0),t.rotateX(Math.PI/2),new THREE.Mesh(t,new THREE.MeshNormalMaterial)}function o(t,e){for(var r=t*e,i=new Uint8Array(r),o=new ImprovedNoise,s=1,n=100*Math.random(),a=0;4>a;a++){for(var p=0;r>p;p++){var c=p%t,h=~~(p/t);i[p]+=Math.abs(o.noise(c/s,h/s,n)*s*1.75)}s*=5}return i}var s=function(t){this.parent=t};s.prototype.init=function(t){return new n(this.parent)};var n=function(t){this.id="world0",this.interceptor={raycaster:new THREE.Raycaster,mouse:new THREE.Vector2,renderer:t.S.renderer,camera:t.S.camera};var e=new THREE.Object3D;this.map={},this.getRoot=function(){return e},this.add("axisHelper",new THREE.AxisHelper(500)),this.add("terrain",this.getTerrain()),this.add("helper",i()),document.addEventListener("mousemove",a.bind(this),!1)};n.prototype.add=function(t,e){this.map[t]=e,this.getRoot().add(e)},n.prototype.get=function(t){return this.map[t]},n.prototype.dig2=function(t){var e=t.face,r=this.geometry,i=3*e.a,o={x:r.attributes.position.array[i],y:r.attributes.position.array[i+1],z:r.attributes.position.array[i+2]},s=3*e.b,n={x:r.attributes.position.array[s],y:r.attributes.position.array[s+1],z:r.attributes.position.array[s+2]},a=3*e.c,p={x:r.attributes.position.array[a],y:r.attributes.position.array[a+1],z:r.attributes.position.array[a+2]};console.info(o,n,p),r.attributes.position.array[i+1]+=1,r.attributes.position.array[s+1]+=1,r.attributes.position.array[a+1]+=1,r.verticesNeedUpdate=!0,r.normalsNeedUpdate=!0,r.elementsNeedUpdate=!0,r.computeVertexNormals(),r.computeFaceNormals()},n.prototype.dig=function(t){var e=t.face,r=this.geometry,i=r.vertices[e.a];r.vertices[e.b],r.vertices[e.c];i.y+=1,r.verticesNeedUpdate=!0,r.normalsNeedUpdate=!0,r.elementsNeedUpdate=!0,r.computeVertexNormals(),r.computeFaceNormals()};var a=function(t){this.interceptor.mouse.x=t.clientX/this.interceptor.renderer.domElement.clientWidth*2-1,this.interceptor.mouse.y=2*-(t.clientY/this.interceptor.renderer.domElement.clientHeight)+1,this.interceptor.raycaster.setFromCamera(this.interceptor.mouse,this.interceptor.camera);var e=this.interceptor.raycaster.intersectObject(this.get("terrain"));e.length>0?this.intersect={x:e[0].point.x,y:e[0].point.y,z:e[0].point.z,obj:e[0]}:this.intersect=void 0},p=1024,c=1024;n.prototype.getTerrainGeometry=function(){if(!this.geometry){var t=(o(p,c),new THREE.PlaneGeometry(1e3,1e3,p-1,c-1));t.rotateX(-Math.PI/2),t.computeFaceNormals(),t.dynamic=!0,this.geometry=t}return this.geometry},n.prototype.getTerrain=function(){var t=new THREE.Mesh(this.getTerrainGeometry(),new THREE.MeshBasicMaterial({wireframe:!0}));return t},n.prototype.updateTerrain=function(t){this.geometry.verticesNeedUpdate=!0},e.exports=s},{}],"/home/gurbano/workspace/snippets/cgen/app/scripts/main.js":[function(t,e,r){"use strict";var i=t("./app/cgen");$(document).ready(function(){var t=new i({target:"three-canvas",userId:"oath01",userName:"gurbano"});t.hello().initHardware({}).initWorld({}).start()})},{"./app/cgen":"/home/gurbano/workspace/snippets/cgen/app/scripts/app/cgen.js"}]},{},["/home/gurbano/workspace/snippets/cgen/app/scripts/main.js"]);